<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>felice.consumer documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Felice</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction to kafka</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>felice</span></div></div></li><li class="depth-2 branch"><a href="felice.async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async</span></div></a></li><li class="depth-2 branch current"><a href="felice.consumer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>consumer</span></div></a></li><li class="depth-2 branch"><a href="felice.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="felice.producer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>producer</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="felice.consumer.html#var-close.21"><div class="inner"><span>close!</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-commit-message-offset"><div class="inner"><span>commit-message-offset</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-commit-sync"><div class="inner"><span>commit-sync</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-consumer"><div class="inner"><span>consumer</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-consumer-record-.3Emap"><div class="inner"><span>consumer-record-&gt;map</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-metrics"><div class="inner"><span>metrics</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-poll"><div class="inner"><span>poll</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-poll-.3Eall-records"><div class="inner"><span>poll-&gt;all-records</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-poll-.3Erecords-by-topic"><div class="inner"><span>poll-&gt;records-by-topic</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-poll-and-process"><div class="inner"><span>poll-and-process</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-poll-loop"><div class="inner"><span>poll-loop</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-subscribe"><div class="inner"><span>subscribe</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-subscription"><div class="inner"><span>subscription</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-topic-partition-.3Emap"><div class="inner"><span>topic-partition-&gt;map</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-unsubscribe"><div class="inner"><span>unsubscribe</span></div></a></li><li class="depth-1"><a href="felice.consumer.html#var-wakeup"><div class="inner"><span>wakeup</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">felice.consumer</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-close.21"><h3>close!</h3><div class="usage"><code>(close! consumer)</code><code>(close! consumer timeout)</code></div><div class="doc"><pre class="plaintext">Tries to close the consumer cleanly within the specified timeout in ms (defaults to 30 secs).
This method waits up to timeout for the consumer to complete pending commits and leave the group.
If auto-commit is enabled, this will commit the current offsets if possible within the timeout.
If the consumer is unable to complete offset commits and gracefully leave the group before the timeout expires, the consumer is force closed.</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L184">view source</a></div></div><div class="public anchor" id="var-commit-message-offset"><h3>commit-message-offset</h3><div class="usage"><code>(commit-message-offset consumer {:keys [partition topic offset], :as record})</code></div><div class="doc"><pre class="plaintext">Commit a specific record

consumer must be a KafkaConsumer object

record must be a map with :partition :topic and :offset</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L21">view source</a></div></div><div class="public anchor" id="var-commit-sync"><h3>commit-sync</h3><div class="usage"><code>(commit-sync consumer)</code></div><div class="doc"><pre class="plaintext">Commit offsets returned on the last `poll()` for all the subscribed list of topics and partitions.

consumer must be a KafkaConsumer object</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L14">view source</a></div></div><div class="public anchor" id="var-consumer"><h3>consumer</h3><div class="usage"><code>(consumer conf)</code><code>(consumer conf key-deserializer value-deserializer)</code><code>(consumer conf key-deserializer value-deserializer topics)</code></div><div class="doc"><pre class="plaintext">create a consumer

conf is a map {:keyword value} (for all  possibilities see <a href="https://kafka.apache.org/documentation/#consumerconfigs)">https://kafka.apache.org/documentation/#consumerconfigs)</a>

key and value deserializer can be one of :long :string :t+json :t+mpack
with the 1 argument arity, :key.deserializer and :value.deserializer must be provided in conf

you can optionaly provide a list of topics to subscribe to</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L165">view source</a></div></div><div class="public anchor" id="var-consumer-record-.3Emap"><h3>consumer-record-&gt;map</h3><div class="usage"><code>(consumer-record-&gt;map record)</code></div><div class="doc"><pre class="plaintext">transforms a ConsumerRecord to a clojure map containing :key :value :offset :topic :partition :timestamp :timestamp-type and :header 
</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L87">view source</a></div></div><div class="public anchor" id="var-metrics"><h3>metrics</h3><div class="usage"><code>(metrics consumer)</code></div><div class="doc"><pre class="plaintext">returns a list of mtrics mapkept by the consumer
</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L40">view source</a></div></div><div class="public anchor" id="var-poll"><h3>poll</h3><div class="usage"><code>(poll consumer timeout)</code></div><div class="doc"><pre class="plaintext">Fetch data for the topics or partitions specified using one of the subscribe/assign APIs. This method returns immediately if there are records available. Otherwise, it will await the timeout ms. If the timeout expires, an empty record set will be returned.
</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L69">view source</a></div></div><div class="public anchor" id="var-poll-.3Eall-records"><h3>poll-&gt;all-records</h3><div class="usage"><code>(poll-&gt;all-records records)</code></div><div class="doc"><pre class="plaintext">takes the return off a poll (see ConsumerRecords)
returns a lazy seq of records as clojure maps</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L99">view source</a></div></div><div class="public anchor" id="var-poll-.3Erecords-by-topic"><h3>poll-&gt;records-by-topic</h3><div class="usage"><code>(poll-&gt;records-by-topic records)</code></div><div class="doc"><pre class="plaintext">takes the return of a poll (see ConsumerRecords)
returns a map {topic records-seq}</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L106">view source</a></div></div><div class="public anchor" id="var-poll-and-process"><h3>poll-and-process</h3><div class="usage"><code>(poll-and-process consumer timeout process-fn)</code></div><div class="doc"><pre class="plaintext">Poll records and run process-fn on each of them (presumably for side effects)
</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L118">view source</a></div></div><div class="public anchor" id="var-poll-loop"><h3>poll-loop</h3><div class="usage"><code>(poll-loop consumer process-record-fn &amp; [{:keys [poll-timeout auto-close? on-error-fn], :or {poll-timeout 2000, auto-close? false}}])</code></div><div class="doc"><pre class="plaintext">Start a consumer loop, calling a callback for each record, and returning a funcion
to stop the loop.

### Parameters
             consumer: consumer context
    process-record-fn: function to call with each record polled
              options: {:poll-timeout 2000 ; duration of a polling without events (ms)
                        :auto-close?  false; close the consumer on exit
                        :on-error-fn  (fn [ex] ...); called on exception

### Returns
              stop-fn: callback function to stop the loop</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L126">view source</a></div></div><div class="public anchor" id="var-subscribe"><h3>subscribe</h3><div class="usage"><code>(subscribe consumer &amp; topics)</code></div><div class="doc"><pre class="plaintext">subscribe the consumer to one or more topics
automaticly resubscribes previous subscriptions
returns the consumer</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L52">view source</a></div></div><div class="public anchor" id="var-subscription"><h3>subscription</h3><div class="usage"><code>(subscription consumer)</code></div><div class="doc"><pre class="plaintext">returns the set of currenctly subscribed topics
</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L47">view source</a></div></div><div class="public anchor" id="var-topic-partition-.3Emap"><h3>topic-partition-&gt;map</h3><div class="usage"><code>(topic-partition-&gt;map topic-partition)</code></div><div class="doc"><pre class="plaintext">converts a TopicPartition object to a clojure map containing :topic and :partition
</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L81">view source</a></div></div><div class="public anchor" id="var-unsubscribe"><h3>unsubscribe</h3><div class="usage"><code>(unsubscribe consumer)</code></div><div class="doc"><pre class="plaintext">Unsubscribe from all topics currently subscribed
returns the consumer</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L60">view source</a></div></div><div class="public anchor" id="var-wakeup"><h3>wakeup</h3><div class="usage"><code>(wakeup consumer)</code></div><div class="doc"><pre class="plaintext">Wakeup the consumer. This method is thread-safe and is useful in particular to abort a long poll.
The thread which is blocking in an operation will throw WakeupException. If no thread is blocking in a method which can throw WakeupException, the next call to such a method will raise it instead.</pre></div><div class="src-link"><a href="https://gitlab.oscaroad.com/it-dev/felice/blob/5c4b6458e284262be9a28279445adba4dc0b5483/src/felice/consumer.clj#L74">view source</a></div></div></div></body></html>